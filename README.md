# WinTaskShedulerGuard
Выводит сообщение при добавлении в планировщик задач

## Преамбула
При установке пиратских игр стали прописываться задачи в планировщик: при запуске ОС открыть браузер с сайтом-маршрутизатором на рекламу.

Захотелось сделать скрипт, который предупреждает о добавлении новых элементов

## Решение
На Windows 10 используем системные возможности через Планировщик задач + VBS скрипт в качестве действия планировщика. Будет показывать системное сообщение.

### Шаг 1. Создать VBS скрипт
Скачиваем [show_msg.vbs](https://github.com/worldisnothing/WinTaskShedulerGuard/blob/main/show_msg.vbs)  из репозитория и кладем в любое удобное место.

### Шаг 2. Создать задачу в Планировщике задач
1. Открыть taskschd.msc
2. Выбрать "Создать простую задачу".
3. Задаем имя и описание (не обязательно)
4. Триггер -> при занесении в журнал указанного события
5. Журнал -> Microsoft-Windows-TaskScheduler/Работает
6. Источник -> TaskScheduler
7. Код события -> 106 (106 - код события на создание задачи)
8. Действие -> Запустить программу
9. Выбираем путь до сохраненного ранее скрипта с шага 1.

Должно получиться следующее:

Триггер: 

<img width="1424" height="82" alt="image" src="https://github.com/user-attachments/assets/a1ddea57-0b7e-4676-bcda-d8834b23aa09" />

Действие: 

<img width="503" height="82" alt="image" src="https://github.com/user-attachments/assets/62ec6a46-d21a-468b-9cc1-2275a5d1a964" />

### Шаг 3. Готово, Вы восхитительны!

## TODO
1. Реализовать кнопки "разрешить" и "запретить".

- Разрешить - аналог кнопки "Ок". Просто закрывает окно с сообщением;

- Запретить - удаляет задачу из планировщика событий, информацию о которой только что вывел.

2. Выводить только ту задачу, которая в последствии не была удалена (изменение имени невозможно, с этим проблем нет)
